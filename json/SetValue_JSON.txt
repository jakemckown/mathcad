(:= (@FUNCTION (@LABEL VARIABLE (@ID SetValue (@SUB JSON))) (@ARGS (@LABEL VARIABLE Arguments))) (@PROGRAM (@ASSIGN (@LABEL VARIABLE ErrorMessage) "This function takes a single vector with the values Matrix, Path, and NewValue.") (@IF (@NOT (@APPLY (@LABEL FUNCTION IsArray) (@ARGS (@LABEL VARIABLE Arguments)))) (@BODY (@RETURN (@APPLY (@LABEL FUNCTION error) (@ARGS (@LABEL VARIABLE ErrorMessage)))))) (@IF (@EQ (@APPLY (@LABEL FUNCTION rows) (@ARGS (@LABEL VARIABLE Arguments))) 4) (@BODY (@ASSIGN (@MATRIX 4 1 (@LABEL VARIABLE Matrix) (@LABEL VARIABLE Path) (@LABEL VARIABLE NewValue) (@LABEL VARIABLE Row)) (@LABEL VARIABLE Arguments))) (@EQ (@APPLY (@LABEL FUNCTION rows) (@ARGS (@LABEL VARIABLE Arguments))) 3) (@BODY (@ASSIGN (@MATRIX 3 1 (@LABEL VARIABLE Matrix) (@LABEL VARIABLE Path) (@LABEL VARIABLE NewValue)) (@LABEL VARIABLE Arguments)) (@ASSIGN (@LABEL VARIABLE Row) 0)) (@BODY (@RETURN (@APPLY (@LABEL FUNCTION error) (@ARGS (@LABEL VARIABLE ErrorMessage)))))) (@ASSIGN (@LABEL VARIABLE ErrorMessage) "Path must be a string or list of indices.") (@IF (@APPLY (@LABEL FUNCTION IsString) (@ARGS Path)) (@BODY (@ASSIGN (@LABEL VARIABLE Indices) (@INDEX (@PARENS (@APPLY (@ID GetValue (@SUB JSON)) (@ARGS (@MATRIX 3 1 (@LABEL VARIABLE Matrix) (@LABEL VARIABLE Path) "indices")))) 1))) (@APPLY IsArray (@ARGS Path)) (@BODY (@ASSIGN (@LABEL VARIABLE Indices) Path)) (@BODY (@RETURN (@APPLY (@LABEL FUNCTION error) (@ARGS (@LABEL VARIABLE ErrorMessage)))))) (@ASSIGN (@LABEL VARIABLE Value) (@INDEX Matrix (@SEP (@INDEX (@LABEL VARIABLE Indices) (@SEP Row 0)) (@INDEX (@LABEL VARIABLE Indices) (@SEP Row 1))))) (@ASSIGN (@INDEX (@LABEL VARIABLE Matrix) (@SEP (@INDEX (@LABEL VARIABLE Indices) (@SEP Row 0)) (@INDEX (@LABEL VARIABLE Indices) (@SEP Row 1)))) (@IF (@EQ Row (- (@APPLY rows (@ARGS Indices)) 1)) (@BODY NewValue) (@BODY (@APPLY (@LABEL VARIABLE (@ID SetValue (@SUB JSON))) (@ARGS (@MATRIX 4 1 (@LABEL VARIABLE Value) (@LABEL VARIABLE Indices) (@LABEL VARIABLE NewValue) (+ (@LABEL VARIABLE Row) 1))))))) (@RETURN Matrix)))