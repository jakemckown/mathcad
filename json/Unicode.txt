(:= (@FUNCTION (@LABEL VARIABLE Unicode) (@ARGS (@LABEL VARIABLE Code))) (@PROGRAM (@ASSIGN (@LABEL VARIABLE ErrorMessage) "Only valid Unicode strings are accepted as input.") (@IF (@NOT (@APPLY IsString (@ARGS (@LABEL VARIABLE Code)))) (@BODY (@RETURN (@APPLY error (@ARGS (@LABEL VARIABLE ErrorMessage))))) (@OR (> (@APPLY (@LABEL FUNCTION strlen) (@ARGS (@LABEL VARIABLE Code))) 4) (@LEQ (@APPLY strlen (@ARGS (@LABEL VARIABLE Code))) 0)) (@BODY (@RETURN (@APPLY error (@ARGS (@LABEL VARIABLE ErrorMessage))))) (@BODY (@IF (< (@APPLY strlen (@ARGS (@LABEL VARIABLE Code))) 4) (@BODY (@ASSIGN (@LABEL VARIABLE Padding) "") (@FOR (@LABEL VARIABLE i) (@RANGE 1 (- 4 (@APPLY strlen (@ARGS (@LABEL VARIABLE Code))))) (@BODY (@ASSIGN (@LABEL VARIABLE Padding) (@APPLY concat (@ARGS (@SEP Padding "0")))))) (@ASSIGN (@LABEL VARIABLE Code) (@APPLY concat (@ARGS (@SEP Padding (@LABEL VARIABLE Code))))))))) (@ASSIGN (@LABEL VARIABLE Code) (@MATRIX 4 1 (@APPLY (@LABEL FUNCTION substr) (@ARGS (@SEP (@SEP Code 3) 1))) (@APPLY (@LABEL FUNCTION substr) (@ARGS (@SEP (@SEP Code 2) 1))) (@APPLY (@LABEL FUNCTION substr) (@ARGS (@SEP (@SEP Code 1) 1))) (@APPLY (@LABEL FUNCTION substr) (@ARGS (@SEP (@SEP Code 0) 1))))) (@FOR (@LABEL VARIABLE i) (@RANGE 0 3) (@BODY (@IF (@EQ (@APPLY (@LABEL FUNCTION search) (@ARGS (@SEP (@SEP "0123456789abcdefABCDEF" (@INDEX (@LABEL VARIABLE Code) i)) 0))) (@NEG 1)) (@BODY (@RETURN (@APPLY error (@ARGS (@LABEL VARIABLE ErrorMessage)))))) (@IF (@GEQ (@APPLY (@LABEL FUNCTION search) (@ARGS (@SEP (@SEP "abcdef" (@INDEX (@LABEL VARIABLE Code) i)) 0))) 0) (@BODY (@ASSIGN (@INDEX (@LABEL VARIABLE Code) i) (@APPLY vec2str (@ARGS (- (@APPLY str2vec (@ARGS (@INDEX (@LABEL VARIABLE Code) i))) (@MATRIX 1 1 32))))))))) (@ASSIGN (@LABEL VARIABLE Conversions) (@MATRIX 16 2 "0" 0 "1" 1 "2" 2 "3" 3 "4" 4 "5" 5 "6" 6 "7" 7 "8" 8 "9" 9 "A" 10 "B" 11 "C" 12 "D" 13 "E" 14 "F" 15)) (@FOR (@LABEL VARIABLE i) (@RANGE 0 3) (@BODY (@ASSIGN (@INDEX (@LABEL VARIABLE Code) i) (@INDEX (@APPLY (@LABEL FUNCTION vlookup) (@ARGS (@SEP (@SEP (@INDEX Code i) Conversions) 1))) 0)))) (@ASSIGN (@LABEL VARIABLE i) (@RANGE 0 3)) (@ASSIGN (@LABEL VARIABLE Code) (@SUM i @PLACEHOLDER (* (@INDEX Code i) (^ 16 i)))) (@TRY (@BODY (@RETURN (@APPLY vec2str (@ARGS (@MATRIX 1 1 Code))))) (@BODY (@RETURN (@APPLY error (@ARGS (@LABEL VARIABLE ErrorMessage))))))))